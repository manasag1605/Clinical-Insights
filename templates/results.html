<!-- results.html -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Medical Report Dashboard</title>
    <!-- Link to external stylesheet (if any) -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <style>
    /* ----------- GLOBAL ----------- */
    body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(135deg, #eaf4ff, #f7fbff);
        margin: 0;
    }

    /* Page wrapper for centered dashboard */
    .dashboard-wrapper {
        max-width: 900px;
        margin: 40px auto;
        padding: 0 20px;
    }

    /* Main white card containing all results */
    .results-card {
        background: white;
        border-radius: 22px;
        padding: 35px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
    }

    /* Title styling with gradient text */
    .results-title {
        font-size: 2rem;
        font-weight: 800;
        background: linear-gradient(90deg, hsl(210 90% 45%), hsl(185 60% 50%));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-align: center;
        margin-bottom: 30px;
    }

    /* ----------- INDIVIDUAL RESULT BLOCKS ----------- */
    .result-block {
        padding: 22px;
        border-radius: 16px;
        background: #ffffff;
        margin-bottom: 20px;
        border: 1px solid #edf2f7;
        transition: transform .15s ease, box-shadow .15s ease;
    }

    .result-block:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(0,0,0,0.08);
    }

    /* Heading with small icon */
    .result-title {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 10px;
    }

    .result-title span {
        font-size: 1.5rem;
    }

    /* Themed left border colors for blocks */
    .severity { border-left: 6px solid hsl(210 90% 45%); }
    .severity .result-title { color: hsl(210 90% 35%); }

    .abnormal { border-left: 6px solid hsl(30 85% 48%); }
    .abnormal .result-title { color: hsl(30 85% 40%); }

    .precautions { border-left: 6px solid hsl(150 60% 40%); }
    .precautions .result-title { color: hsl(150 60% 35%); }

    .meds { border-left: 6px solid hsl(270 60% 55%); }
    .meds .result-title { color: hsl(270 60% 45%); }

    .doctor { border-left: 6px solid hsl(0 70% 50%); }
    .doctor .result-title { color: hsl(0 70% 45%); }

    /* CTA button */
    .results-btn {
        display: block;
        text-align: center;
        padding: 14px;
        background: hsl(210 90% 45%);
        color: white;
        border-radius: 12px;
        margin-top: 25px;
        text-decoration: none;
        font-weight: 600;
        transition: background .15s ease;
    }

    .results-btn:hover {
        background: hsl(210 90% 40%);
    }

    /* --------- Severity Ring --------- */
    .severity-flex {
        display: flex;
        align-items: center;
        gap: 30px;
        flex-wrap: wrap;
    }

    .severity-ring {
        position: relative;
        width: 110px;
        height: 110px;
    }

    .severity-score {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 1.3rem;
        font-weight: 700;
        color: hsl(210 90% 35%);
    }

    /* Circular progress ring styles (stroke based) */
    .progress-ring circle {
        fill: none;
        stroke-width: 10;
        stroke-linecap: round;
    }

    .progress-ring-bg {
        stroke: #e2e8f0;
    }

    /* Dynamic stroke offset uses CSS variable --severity */
    .progress-ring-value {
        stroke: hsl(210 90% 45%);
        stroke-dasharray: 283;
        stroke-dashoffset: calc(283 - (283 * var(--severity) / 100));
        transition: stroke-dashoffset 1s ease;
    }

    .severity-text {
        max-width: 700px;
    }
    </style>
</head>

<body>

    <!-- Small disclaimer banner -->
    <div class="disclaimer-warning">
        ‚ö†Ô∏è IMPORTANT: AI-generated insights only. This is NOT medical advice. Consult a healthcare professional.
    </div>

    <!-- Dashboard container -->
    <div class="dashboard-wrapper">
        <div class="results-card">

            <!-- Page heading -->
            <h1 class="results-title">Medical Report Summary</h1>

            <!-- Severity Block with ring and short analysis text -->
            <div class="result-block severity">
                <div class="result-title">
                    <span>ü©∫</span> Severity Analysis
                </div>

                <div class="severity-flex">
                    <div class="severity-ring">
                        <svg class="progress-ring" width="110" height="110">
                            <circle class="progress-ring-bg" cx="55" cy="55" r="45" />
                            <circle class="progress-ring-value" cx="55" cy="55" r="45"
                                style="--severity: {{ analysis.severity_score|default(65) }};" />
                        </svg>
                        <div class="severity-score">
                            {{ analysis.severity_score|default(65) }}%
                        </div>
                    </div>

                    <!-- Main severity analysis text pulled from AI analysis -->
                    <p class="severity-text">{{ analysis.severity_analysis }}</p>
                </div>
            </div>

            <!-- Abnormal Findings block (list) -->
            <div class="result-block abnormal">
                <div class="result-title">
                    <span>‚ö†Ô∏è</span> Abnormal Findings
                </div>
                <ul>
                    {% for item in analysis.key_abnormal_findings %}
                        <li>{{ item }}</li>
                    {% endfor %}
                </ul>
            </div>

            <!-- Precautions & Next Steps block (list) -->
            <div class="result-block precautions">
                <div class="result-title">
                    <span>üõ°Ô∏è</span> Precautions & Next Steps
                </div>
                <ul>
                    {% for item in analysis.precautions_and_next_steps %}
                        <li>{{ item }}</li>
                    {% endfor %}
                </ul>
            </div>

            <!-- Medication suggestion block -->
            <div class="result-block meds">
                <div class="result-title">
                    <span>üíä</span> Medication Suggestion
                </div>
                <p>{{ analysis.medication_suggestion }}</p>
            </div>

            <!-- Physician recommendation -->
            <div class="result-block doctor">
                <div class="result-title">
                    <span>üë®‚Äç‚öïÔ∏è</span> Doctor Recommendation
                </div>
                <p>{{ analysis.physician_recommendation }}<br>
                <strong>Specialist:</strong> {{ analysis.recommended_doctor_type }}</p>
            </div>

            <!-- CTA to analyze another report -->
            <a href="/upload" class="results-btn">Analyze Another Report</a>

        </div>
    </div>

</body>
</html>